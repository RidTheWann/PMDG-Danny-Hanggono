"use strict";(()=>{var t={};t.id=867,t.ids=[867],t.modules={517:t=>{t.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},1251:(t,e,a)=>{a.r(e),a.d(e,{headerHooks:()=>d,originalPathname:()=>h,patchFetch:()=>b,requestAsyncStorage:()=>p,routeModule:()=>l,serverHooks:()=>m,staticGenerationAsyncStorage:()=>c,staticGenerationBailout:()=>g});var r={};a.r(r),a.d(r,{GET:()=>u});var n=a(5419),o=a(9108),s=a(9678),i=a(8070);async function u(t){try{let{searchParams:e}=new URL(t.url),a=e.get("month")||(new Date().getMonth()+1).toString(),r=e.get("year")||new Date().getFullYear().toString(),n="https://script.google.com/macros/s/AKfycbxnyacmLOW4Ts93_S56wLJj1i4eT76sm1SvJhXu8w-MAmyAtj9DPtoaY28mvD9OkmD2/exec";if(!n)throw Error("Google Sheets URL not configured");let o=await fetch(`${n}?action=get&month=${a}&year=${r}`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!o.ok)throw Error("Failed to fetch data from Google Sheets");let s=((await o.json()).data||[]).slice(1),u={},l={},p=0,c=0,m=0;s.forEach(t=>{if(0===t.length)return;let e=t[0],a=t[5]||"",r={obat:"Ya"===t[6],cabut_anak:"Ya"===t[7],cabut_dewasa:"Ya"===t[8],tambal_sementara:"Ya"===t[9],tambal_tetap:"Ya"===t[10],scaling:"Ya"===t[11],rujuk:"Ya"===t[12],lainnya:t[13]&&""!==t[13].trim()};Object.entries(r).forEach(([t,e])=>{e&&(l[t]=(l[t]||0)+1)});let n=e.split("T")[0];u[n]||(u[n]={date:n,totalPatients:0,bpjsPatients:0,umumPatients:0,treatments:{}}),u[n].totalPatients+=1,"BPJS"===a?(u[n].bpjsPatients+=1,c+=1):"UMUM"===a&&(u[n].umumPatients+=1,m+=1),Object.entries(r).forEach(([t,e])=>{e&&(u[n].treatments[t]=(u[n].treatments[t]||0)+1)}),p+=1});let d=Object.entries(l).sort(([,t],[,e])=>e-t)[0]?.[0]||"Tidak ada",g=Object.values(u).sort((t,e)=>new Date(t.date).getTime()-new Date(e.date).getTime()),h=new Date(parseInt(r),parseInt(a),0).getDate(),b=p/h;return i.Z.json({totalPatients:p,bpjsPatients:c,umumPatients:m,averagePerDay:b,mostPopularTreatment:{obat:"Obat",cabut_anak:"Cabut Anak",cabut_dewasa:"Cabut Dewasa",tambal_sementara:"Tambal Sementara",tambal_tetap:"Tambal Tetap",scaling:"Scaling",rujuk:"Rujuk",lainnya:"Lainnya"}[d]||d,dailyData:g})}catch(t){return console.error("Error generating report:",t),i.Z.json({error:"Failed to generate report"},{status:500})}}let l=new n.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/reports/route",pathname:"/api/reports",filename:"route",bundlePath:"app/api/reports/route"},resolvedPagePath:"C:\\Users\\putra\\Downloads\\project-next-praktek\\app\\api\\reports\\route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:p,staticGenerationAsyncStorage:c,serverHooks:m,headerHooks:d,staticGenerationBailout:g}=l,h="/api/reports/route";function b(){return(0,s.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:c})}}};var e=require("../../../webpack-runtime.js");e.C(t);var a=t=>e(e.s=t),r=e.X(0,[638,206],()=>a(1251));module.exports=r})();