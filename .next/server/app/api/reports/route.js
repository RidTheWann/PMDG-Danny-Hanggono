"use strict";(()=>{var t={};t.id=867,t.ids=[867],t.modules={517:t=>{t.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},1251:(t,e,a)=>{a.r(e),a.d(e,{headerHooks:()=>g,originalPathname:()=>b,patchFetch:()=>y,requestAsyncStorage:()=>c,routeModule:()=>p,serverHooks:()=>d,staticGenerationAsyncStorage:()=>m,staticGenerationBailout:()=>h});var r={};a.r(r),a.d(r,{GET:()=>l,dynamic:()=>u});var n=a(5419),o=a(9108),s=a(9678),i=a(8070);let u="force-dynamic";async function l(t){try{let{searchParams:e}=new URL(t.url),a=e.get("month")||(new Date().getMonth()+1).toString(),r=e.get("year")||new Date().getFullYear().toString(),n="https://script.google.com/macros/s/AKfycbxnyacmLOW4Ts93_S56wLJj1i4eT76sm1SvJhXu8w-MAmyAtj9DPtoaY28mvD9OkmD2/exec";if(!n)throw Error("Google Sheets URL not configured");let o=await fetch(`${n}?action=get&month=${a}&year=${r}`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!o.ok)throw Error("Failed to fetch data from Google Sheets");let s=((await o.json()).data||[]).slice(1),u={},l={},p=0,c=0,m=0;s.forEach(t=>{if(!Array.isArray(t)||0===t.length)return;let e=String(t[0]??""),a=String(t[5]??""),r={obat:"Ya"===t[6],cabut_anak:"Ya"===t[7],cabut_dewasa:"Ya"===t[8],tambal_sementara:"Ya"===t[9],tambal_tetap:"Ya"===t[10],scaling:"Ya"===t[11],rujuk:"Ya"===t[12],lainnya:"string"==typeof t[13]&&""!==t[13].trim()};Object.entries(r).forEach(([t,e])=>{e&&(l[t]=(l[t]||0)+1)});let n=e.split("T")[0];u[n]||(u[n]={date:n,totalPatients:0,bpjsPatients:0,umumPatients:0,treatments:{}});let o=u[n];o.totalPatients+=1,"BPJS"===a?(o.bpjsPatients+=1,c+=1):"UMUM"===a&&(o.umumPatients+=1,m+=1),Object.entries(r).forEach(([t,e])=>{e&&(o.treatments[t]=(o.treatments[t]||0)+1)}),p+=1});let d=Object.entries(l).sort(([,t],[,e])=>e-t)[0]?.[0]||"Tidak ada",g=Object.values(u).sort((t,e)=>String(t.date).localeCompare(String(e.date))),h=new Date(parseInt(r),parseInt(a),0).getDate(),b=p/h;return i.Z.json({totalPatients:p,bpjsPatients:c,umumPatients:m,averagePerDay:b,mostPopularTreatment:{obat:"Obat",cabut_anak:"Cabut Anak",cabut_dewasa:"Cabut Dewasa",tambal_sementara:"Tambal Sementara",tambal_tetap:"Tambal Tetap",scaling:"Scaling",rujuk:"Rujuk",lainnya:"Lainnya"}[d]||d,dailyData:g})}catch(t){return i.Z.json({error:"Failed to generate report"},{status:500})}}let p=new n.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/reports/route",pathname:"/api/reports",filename:"route",bundlePath:"app/api/reports/route"},resolvedPagePath:"C:\\Users\\putra\\Downloads\\project-next-praktek\\app\\api\\reports\\route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:c,staticGenerationAsyncStorage:m,serverHooks:d,headerHooks:g,staticGenerationBailout:h}=p,b="/api/reports/route";function y(){return(0,s.patchFetch)({serverHooks:d,staticGenerationAsyncStorage:m})}}};var e=require("../../../webpack-runtime.js");e.C(t);var a=t=>e(e.s=t),r=e.X(0,[638,206],()=>a(1251));module.exports=r})();